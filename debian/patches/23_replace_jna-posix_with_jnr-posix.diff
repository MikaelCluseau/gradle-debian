Description: Replace jna-posix library with jnr-posix
 jna-posix is not longer supported and was replaced with jnr-posix.
Author: Miguel Landaeta <miguel@miguel.cc>
Forwarded: no
Last-Update: 2011-06-02

diff --git a/subprojects/core/core.gradle b/subprojects/core/core.gradle
index 4260cbd..ba3c9e0 100644
--- a/subprojects/core/core.gradle
+++ b/subprojects/core/core.gradle
@@ -54,7 +54,8 @@ dependencies {
             //"slide:webdavlib:2.0@jar",
             libraries.asm_all,
             'org.fusesource.jansi:jansi:1.4',
-            'org.jruby.ext.posix:jna-posix:1.0.1'
+            'org.jruby.ext.posix:jnr-posix:1.1.4',
+            'com.kenai.constantine:constantine:0.7'
 
     runtime 'net.java.dev.jna:jna:3.2.7'
 
diff --git a/subprojects/core/src/main/groovy/org/gradle/process/internal/child/WorkerProcessClassPathProvider.java b/subprojects/core/src/main/groovy/org/gradle/process/internal/child/WorkerProcessClassPathProvider.java
index 720e287..2f5aa9a 100644
--- a/subprojects/core/src/main/groovy/org/gradle/process/internal/child/WorkerProcessClassPathProvider.java
+++ b/subprojects/core/src/main/groovy/org/gradle/process/internal/child/WorkerProcessClassPathProvider.java
@@ -35,7 +35,8 @@ public class WorkerProcessClassPathProvider extends AbstractClassPathProvider {
 
     public WorkerProcessClassPathProvider(CacheRepository cacheRepository) {
         this.cacheRepository = cacheRepository;
-        add("WORKER_PROCESS", toPatterns("gradle-core", "slf4j-api", "logback-classic", "logback-core", "jul-to-slf4j", "jansi", "jna", "jna-posix"));
+        //add("WORKER_PROCESS", toPatterns("gradle-core", "slf4j-api", "logback-classic", "logback-core", "jul-to-slf4j", "jansi", "jna", "jna-posix"));
+        add("WORKER_PROCESS", toPatterns("gradle-core", "slf4j-api", "logback-classic", "logback-core", "jul-to-slf4j", "jansi", "jna", "jnr-posix"));
     }
 
     public Set<File> findClassPath(String name) {
diff --git a/subprojects/core/src/main/groovy/org/gradle/util/PosixUtil.java b/subprojects/core/src/main/groovy/org/gradle/util/PosixUtil.java
index 96c90a8..62eb360 100644
--- a/subprojects/core/src/main/groovy/org/gradle/util/PosixUtil.java
+++ b/subprojects/core/src/main/groovy/org/gradle/util/PosixUtil.java
@@ -24,6 +24,8 @@ import java.io.File;
 import java.io.InputStream;
 import java.io.PrintStream;
 
+import com.kenai.constantine.platform.Errno;
+
 public class PosixUtil {
     private static final POSIX POSIX = POSIXFactory.getPOSIX(new POSIXHandlerImpl(), true);
 
@@ -32,7 +34,7 @@ public class PosixUtil {
     }
     
     private static class POSIXHandlerImpl implements POSIXHandler {
-        public void error(POSIX.ERRORS errors, String message) {
+        public void error(Errno error, String extraData) {
             throw new UnsupportedOperationException();
         }
 
